const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-8fKKtPav.js","assets/index-BNfSSo9G.js","assets/index-C1EfO2mq.css","assets/parseSignature-CUmsX7QT.js","assets/localBatchGatewayRequest-oVrTclf5.js","assets/secp256k1-CF6arsBz.js","assets/hashTypedData-DKV9ZdOm.js","assets/index-DwEFwkDR.js","assets/index-BJZQQL6j.js"])))=>i.map(i=>d[i]);
import{d7 as C,bo as v,aV as I,d8 as D,b$ as g,b1 as _,d9 as A,da as y,cm as L}from"./index-BNfSSo9G.js";import{db as N}from"./index-BNfSSo9G.js";function q(p={}){let l,d,r,a;return C(n=>({id:"baseAccount",name:"Base Account",rdns:"app.base.account",type:"baseAccount",async connect({chainId:t,withCapabilities:e,...c}={}){var o;try{const i=await this.getProvider(),f=t??((o=n.chains[0])==null?void 0:o.id);if(!f)throw new D;let{accounts:h,currentChainId:w}=await(async()=>{if(c.isReconnecting)return{accounts:(await i.request({method:"eth_accounts",params:[]})).map(s=>({address:v(s)})),currentChainId:await this.getChainId()};const u=await i.request({method:"wallet_connect",params:[{capabilities:"capabilities"in c&&c.capabilities?c.capabilities:{},chainIds:[g(f),...n.chains.filter(s=>s.id!==f).map(s=>g(s.id))]}]});return{accounts:u.accounts.map(s=>({address:v(s.address),capabilities:s.capabilities??{}})),currentChainId:Number(u.chainIds[0])}})();if(d||(d=this.onAccountsChanged.bind(this),i.on("accountsChanged",d)),r||(r=this.onChainChanged.bind(this),i.on("chainChanged",r)),a||(a=this.onDisconnect.bind(this),i.on("disconnect",a)),t&&w!==t){const u=await this.switchChain({chainId:t}).catch(s=>{if(s.code===_.code)throw s;return{id:w}});w=(u==null?void 0:u.id)??w}return{accounts:e?h:h.map(u=>u.address),chainId:w}}catch(i){throw/(user closed modal|accounts received is empty|user denied account|request rejected)/i.test(i.message)?new _(i):i}},async disconnect(){const t=await this.getProvider();d&&(t.removeListener("accountsChanged",d),d=void 0),r&&(t.removeListener("chainChanged",r),r=void 0),a&&(t.removeListener("disconnect",a),a=void 0),t.disconnect()},async getAccounts(){return(await(await this.getProvider()).request({method:"eth_accounts"})).map(e=>v(e))},async getChainId(){const e=await(await this.getProvider()).request({method:"eth_chainId"});return Number(e)},async getProvider(){if(!l){const t=(()=>{var o;return typeof p.preference=="string"?{options:p.preference}:{...p.preference,options:((o=p.preference)==null?void 0:o.options)??"all"}})(),{createBaseAccountSDK:e}=await A(async()=>{const{createBaseAccountSDK:o}=await import("./index-8fKKtPav.js");return{createBaseAccountSDK:o}},__vite__mapDeps([0,1,2,3,4,5,6]));l=e({...p,appChainIds:n.chains.map(o=>o.id),preference:t}).getProvider()}return l},async isAuthorized(){try{return!!(await this.getAccounts()).length}catch{return!1}},async switchChain({addEthereumChainParameter:t,chainId:e}){var i,f,h,w;const c=n.chains.find(u=>u.id===e);if(!c)throw new I(new D);const o=await this.getProvider();try{return await o.request({method:"wallet_switchEthereumChain",params:[{chainId:g(c.id)}]}),c}catch(u){if(u.code===4902)try{let s;t!=null&&t.blockExplorerUrls?s=t.blockExplorerUrls:s=(i=c.blockExplorers)!=null&&i.default.url?[(f=c.blockExplorers)==null?void 0:f.default.url]:[];let b;(h=t==null?void 0:t.rpcUrls)!=null&&h.length?b=t.rpcUrls:b=[((w=c.rpcUrls.default)==null?void 0:w.http[0])??""];const m={blockExplorerUrls:s,chainId:g(e),chainName:(t==null?void 0:t.chainName)??c.name,iconUrls:t==null?void 0:t.iconUrls,nativeCurrency:(t==null?void 0:t.nativeCurrency)??c.nativeCurrency,rpcUrls:b};return await o.request({method:"wallet_addEthereumChain",params:[m]}),c}catch(s){throw new _(s)}throw new I(u)}},onAccountsChanged(t){t.length===0?this.onDisconnect():n.emitter.emit("change",{accounts:t.map(e=>v(e))})},onChainChanged(t){const e=Number(t);n.emitter.emit("change",{chainId:e})},async onDisconnect(t){n.emitter.emit("disconnect");const e=await this.getProvider();d&&(e.removeListener("accountsChanged",d),d=void 0),r&&(e.removeListener("chainChanged",r),r=void 0),a&&(e.removeListener("disconnect",a),a=void 0)}}))}S.type="safe";function S(p={}){const{shimDisconnect:l=!1}=p;let d,r;return C(a=>({id:"safe",name:"Safe",type:S.type,async connect({withCapabilities:n}={}){var o;const t=await this.getProvider();if(!t)throw new y;const e=await this.getAccounts(),c=await this.getChainId();return r||(r=this.onDisconnect.bind(this),t.on("disconnect",r)),l&&await((o=a.storage)==null?void 0:o.removeItem("safe.disconnected")),{accounts:n?e.map(i=>({address:i,capabilities:{}})):e,chainId:c}},async disconnect(){var t;const n=await this.getProvider();if(!n)throw new y;r&&(n.removeListener("disconnect",r),r=void 0),l&&await((t=a.storage)==null?void 0:t.setItem("safe.disconnected",!0))},async getAccounts(){const n=await this.getProvider();if(!n)throw new y;return(await n.request({method:"eth_accounts"})).map(v)},async getProvider(){if(typeof window<"u"&&(window==null?void 0:window.parent)!==window){if(!d){const{default:t}=await A(async()=>{const{default:i}=await import("./index-DwEFwkDR.js").then(f=>f.e);return{default:i}},__vite__mapDeps([7,1,2,6])),e=new t(p),c=await L(()=>e.safe.getInfo(),{timeout:p.unstable_getInfoTimeout??10});if(!c)throw new Error("Could not load Safe information");const o=await(async()=>{const i=await A(()=>import("./index-BJZQQL6j.js").then(f=>f.i),__vite__mapDeps([8,1,2,7,6]));return typeof i.SafeAppProvider!="function"&&typeof i.default.SafeAppProvider=="function"?i.default.SafeAppProvider:i.SafeAppProvider})();d=new o(c,e)}return d}},async getChainId(){const n=await this.getProvider();if(!n)throw new y;return Number(n.chainId)},async isAuthorized(){var n;try{return l&&await((n=a.storage)==null?void 0:n.getItem("safe.disconnected"))?!1:!!(await this.getAccounts()).length}catch{return!1}},onAccountsChanged(){},onChainChanged(){},onDisconnect(){a.emitter.emit("disconnect")}}))}export{q as baseAccount,N as injected,S as safe};
